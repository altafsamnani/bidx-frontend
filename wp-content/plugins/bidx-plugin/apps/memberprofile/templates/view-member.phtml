<?php

$personalDetails = $this->data->bidxMemberProfile->personalDetails;

$useDataSrc = false;
$picSrc     = $personalDetails->profilePicture->document;

if (!$personalDetails->profilePicture->document) {
  $picSrc     = 'holder.js/100x100/industrial/auto/text:No Image';
  $useDataSrc = true;
}

$entrepreneurDetails = $this->data->bidxEntrepreneurProfile[0];

?>

<div class="well profile-block">

  <div class="btn-group controls">
  <?php if ($personalDetails->bidxCanEdit) { ?>
    <a class="btn btn-primary" href="#editMember/<?php echo $personalDetails->ownerId; ?>">Edit</a>
  <?php } ?>
  </div>


  <div class="row-fluid">
    <div class="span3">
      <h4>Member</h4>
      <img height="175px" width="150px" <?php $useDataSrc ? "data-" : "" ?>src="<?php echo $picSrc ?>" class="img-rounded">

    </div>
    <div class="span9"><br/>
      <div class="row-fluid">
        <div class="span12"><h4><?php echo ucwords($personalDetails->firstName . ' ' . $personalDetails->lastName); ?></h4></div>
        <!-- Personal details 6/6 Start -->

<?php
//Language Details
$languageData = $personalDetails->languageDetail;
$languageDetails = $this->getMultiValues($languageData, ', ', 'language');
$motherLanguageDetails = $this->getMultiValues($languageData, ', ', 'language', array('motherLanguage' => '1'));
//Address Details
$addressArr = array($personalDetails->address[0]->street . $personalDetails->address[0]->streetNumber,
  $personalDetails->address[0]->cityTown,
  'country' => $personalDetails->address[0]->country,
  $personalDetails->address[0]->postalCode);

$address = $this->createRowValue($addressArr, ', ');

//CV
$cvDetails = ($entrepreneurDetails->cv) ? '<a href="'.$entrepreneurDetails->cv->document.'" target="_blank" > '.$entrepreneurDetails->cv->documentName.'</a>':'';

$rowValues = array($personalDetails->professionalTitle,
  'gender' => $personalDetails->gender,
  'nationality' => $personalDetails->nationality,
  $personalDetails->dateOfBirth,
  $personalDetails->highestEducation,
  'motherlanguage' => $motherLanguageDetails,
  'language' => $languageDetails,
  $address,
  $cvDetails);
echo $this->addMultipleRows('span12', $rowValues);
?>

        <br/>

<?php
$rowValues = array('E-mail' => $personalDetails->emailAddress,
  'Mobile' => $this->getMultiValues($personalDetails->contactDetail, ', ', 'mobile'),

);
echo $this->addRowsWithLabelAdjacent('span3', 'span3', $rowValues, array('class_label' => 'label label-info'));
?>
<?php
      $rowValues = array('Fax' => $this->data->contactDetail->fax,
        'Landline' => $this->getMultiValues($personalDetails->contactDetail, ', ', 'landLine'),
        );
      echo $this->addRowsWithLabelAdjacent('span3', 'span3', $rowValues, array('class_label' => 'label label-info'));
      ?>
<?php
$rowValues = array('Facebook' => $this->addSocialPluginScript('facebookprofile', $personalDetails->facebook),
                   'Twitter' => $this->addSocialPluginScript('twitterprofile', $personalDetails->twitter),
                   'Linkedin' => $this->addSocialPluginScript('linkedin',$personalDetails->linkedIn) ,
                   'Skype' => $this->addSocialPluginScript('skype',$personalDetails->skype)
         );

      echo $this->addAdjacentRows('span1', $rowValues, array('Skype' => 'skypeclass'));
     // echo $this->addRowsWithLabelAdjacent('span3', 'span3', $rowValues, array('class_label' => 'label label-info'));
 ?>

<?php
//$rowValues = array('Facebook' => $this->addSocialPluginScript('facebook', $personalDetails->facebook),
//                   'Twitter' => $this->addSocialPluginScript('twitter', $personalDetails->twitter));

//echo $this->addRowsWithLabelAdjacent('span3', 'span3', $rowValues, array('class_label' => 'label label-info'));
//echo $this->addAdjacentRows('span6', $rowValues);

?>

      </div>
    </div>
  </div>

<?php
  // Attachments
  //
if ( $personalDetails->attachment && is_array( $personalDetails->attachment )) {

  echo '<h4>Documents</h4>';

  foreach ( $personalDetails->attachment as $attachment ) {

    $documentImage = preg_match( "/^image/i", $attachment->mimeType )
      ? $attachment->document
      : '/wp-content/plugins/bidx-plugin/static/img/iconViewDocument.png';

    echo '<div class="row-fluid"><div class="span3">';
    printf( '<a href="%s" class="documentLink"><img class="img-rounded documentImage" src="%s"></a>', $attachment->document, $documentImage );
    echo '</div>';

    echo '<div class="span9">';
    printf( '<h5 class="documentName">%s</h5>', htmlspecialchars( $attachment->documentName ));
    printf( '<p>%s</p>', htmlspecialchars( $attachment->uploadedDateTime ));
    echo '</div>';

    echo '</div>';
  }
}
?>

</div>
