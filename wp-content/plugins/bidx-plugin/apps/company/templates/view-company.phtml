<?php
    $companyBidxMeta = isset( $this->company->bidxMeta )
        ? $this->company->bidxMeta
        : $this->company;

    $comLogo = $this->exst($this->company->logo->document);
    $countryOperationSpecifics = isset ($this->company->countryOperationSpecifics) ? $this->company->countryOperationSpecifics : NULL;
?>
<div class="bg-primary-light main-padding">
    <h1 class="text-center"><?php echo ($this->companyTitle) ? ucwords( $this->company->name) :''; ?></h1>
</div>

<div class="row">
    <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">

<?php
        if ( $companyBidxMeta->bidxCanEdit )
        {
?>
            <div class="btn-group controls pull-right top-margin-lineheight">
                <a class="btn btn-primary" href="#editCompany/<?php echo $companyBidxMeta->bidxEntityId; ?>"><i class="fa fa-big fa-above fa-pencil"></i> <?php _e( 'Edit', 'bidxplugin' ); ?></a>
            </div>
<?php
        }
?>
    </div>
</div>

<div class="row">
    <div class="col-sm-8 col-sm-offset-2 col-xs-10 col-xs-offset-1">
    <div class="text-center bottom-margin-lineheight top-margin-lineheight">
<?php
        if ( !$comLogo )
        {
            echo '<div class="icons-rounded"><i class="fa fa-tasks text-primary-light"></i></div>';
        }
        else
        {
            echo '<img class="img-responsive center-img" src="'.$comLogo.'"/>';
        }
?>
    </div>
<?php

    $companySite = $this->exst( $this->company->website ) ? sprintf( '<a href="%1$s" target="_blank">%1$s</a>', $this->exst( $this->company->website )) : NULL;

    if ( !empty( $this->company->registered ) )
    {

        $statutoryAddress = $this->exst( $this->company->statutoryAddress );

        $arStatutoryAddress = array();
        if ( $this->exst( $statutoryAddress->streetNumber ) ) { $arStatutoryAddress[] = $statutoryAddress->streetNumber; }
        if ( $this->exst( $statutoryAddress->street ) )       { $arStatutoryAddress[] = $statutoryAddress->street . ', '; }
        if ( $this->exst( $statutoryAddress->postalCode ) )   { $arStatutoryAddress[] = $statutoryAddress->postalCode; }

        $arStatutoryCityCountry = array();
        if ( $this->exst( $statutoryAddress->cityTown ) )     { $arStatutoryCityCountry[] = $statutoryAddress->cityTown; }
        if ( $this->exst( $statutoryAddress->country ) )      { $arStatutoryCityCountry[] = $this->getStaticVal( 'country', $statutoryAddress->country ); }

    }
    $rowValues = array(
        __('Company name','bidxplugin') => $this->exst( $this->company->name ),
        __('Company website','bidxplugin') => $companySite,
        __('Date of registration','bidxplugin') =>  date( 'j F Y', strtotime( $this->company->dateCompanyEstab )),
        __('Legal form of business','bidxplugin') => $this->addExtraValuesToRows( 'legalForm', $this->exst($this->company->legalFormBusiness )),
        __('Statutory address','bidxplugin') => $arStatutoryAddress ? implode( ' ', $arStatutoryAddress ) : NULL,
        __('Statutory city, country','bidxplugin') => $arStatutoryCityCountry ? implode( ', ', $arStatutoryCityCountry ) : NULL,
        __('Fiscal number','bidxplugin') => $this->exst($this->company->fiscalNumber),
        __('Company registration number','bidxplugin') => $this->exst($this->company->registrationNumber),
        __('Number of permanent male employees','bidxplugin') => $this->exst($this->company->numPermMaleEmpl),
        __('Number of permanent female employees','bidxplugin') => $this->exst($this->company->numPermFemaleEmpl),
        __('Number of temporary male employees','bidxplugin') => $this->exst($this->company->numTempMaleEmpl),
        __('Number of temporary female employees','bidxplugin') => $this->exst($this->company->numTempFemaleEmpl)
    );
    echo $this->tableRow( $rowValues );

    if ( $countryOperationSpecifics )
    {
        $header = array (
            __('Country','bidxplugin') => 'country',
            __('Company trade name','bidxplugin') => 'companyTradeName',
            __('Permits and/or licenses','bidxplugin') => 'permitsLicencesObtained',
            __('Company Address','bidxplugin') => 'companyAddress'
        );

        $countryOperationSpecificsHtml = $this->addTableRows( $header, $countryOperationSpecifics, 'table table-bordered', '', array('permitsLicencesObtained' => 'hidden-xs'), array( 'permitsLicencesObtained', 'country', 'companyAddress' ) );
        
        $rowValues = array ( __('Country Operation Specifics','bidxplugin') => $countryOperationSpecificsHtml );
        
        echo $this->addRowsWithLabelBelow ( 'col-sm-12', 'col-sm-12', $rowValues, array ( 'tag_label' => 'h4' ) );
    }
?>
    </div>
</div>
